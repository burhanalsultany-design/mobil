<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ุงุณุชุจูุงู ุฅุฏูุงู ุงููุงุชู ูุฌูุฏุฉ ุงูููู</title>
<style>
:root{--accent:#1e90ff;--accent-dark:#1565c0;--bg1:#e6f2ff;--card:#ffffff}
body{font-family:Tahoma,Arial,Helvetica,sans-serif;background:linear-gradient(180deg,var(--bg1),#d6ecff);margin:0;padding:20px;color:#222}
.wrap{max-width:980px;margin:18px auto;padding:18px;background:var(--card);border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,0.08)}
h1,h2{text-align:center;color:var(--accent-dark)}
.section{margin:16px 0;padding:12px;border-radius:10px;background:#fff;border:1px solid rgba(0,0,0,0.04)}
.q{margin:10px 0;font-weight:700}
.opts{display:flex;flex-wrap:wrap;gap:12px;margin-top:6px}
.opts label{background:#f1f6fb;padding:9px 18px;border-radius:8px;cursor:pointer;border:1px solid rgba(0,0,0,0.04)}
input[type="radio"]{margin-left:6px}
.small{font-size:0.9rem;color:#555}
.actions{text-align:center;margin-top:14px}
button{background:var(--accent);color:#fff;border:none;padding:10px 18px;border-radius:10px;font-size:1rem;cursor:pointer}
button:hover{background:var(--accent-dark)}
#resultBox{margin-top:14px;padding:12px;border-radius:10px;background:#fafafa;border:1px solid rgba(0,0,0,0.04);display:none}
.note{font-size:0.88rem;color:#666;margin-top:8px}
footer{text-align:center;margin-top:16px}
footer a{color:var(--accent);font-weight:700;text-decoration:none}
</style>
</head>
<body>

<div class="wrap">
<h1>ุงุณุชุจูุงู ุฅุฏูุงู ุงูููุงุชู ูุฌูุฏุฉ ุงูููู</h1>

<form id="mainForm">

<!-- ุงูุฌูุณ -->
<div class="section">
  <div class="q">ุงูุฌูุณ โ Gender</div>
  <div class="opts">
    <label><input type="radio" name="gender" value="male" required> ุฐูุฑ (Male)</label>
    <label><input type="radio" name="gender" value="female"> ุฃูุซู (Female)</label>
  </div>
</div>

<!-- SAS-SV -->
<div class="section">
  <h2>SAS-SV โ ูููุงุณ ุฅุฏูุงู ุงููุงุชู (10 ุจููุฏ)</h2>
  <div class="note">ุงุฎุชุฑ ูู 1 (ูุง ุฃูุงูู ุจุดุฏุฉ) ุฅูู 5 (ุฃูุงูู ุจุดุฏุฉ)</div>

  <!-- QUESTIONS -->
  <script>
  const sasQs=[
    "ุฃููููู ุจุนุถ ุงูุฃุนูุงู ุงููุฎุทุทุฉ ุจุณุจุจ ุงุณุชุฎุฏุงูู ูููุงุชู.",
    "ุฃุฌุฏ ุตุนูุจุฉ ูู ุงูุชุฑููุฒ ุฃุซูุงุก ุงูุฏุฑุงุณุฉ ุจุณุจุจ ุงุณุชุฎุฏุงู ุงููุงุชู.",
    "ุฃุดุนุฑ ุจุฃูู ูู ุงููุนุตู ุฃู ุงูุฑูุจุฉ ุฃุซูุงุก ุงุณุชุฎุฏุงู ุงููุงุชู.",
    "ุฃุดุนุฑ ุจุงูุชูุชุฑ ุนูุฏูุง ูุง ุฃููู ููุณููุง ุจุงููุงุชู.",
    "ุฃููุฑ ูู ุงููุงุชู ุญุชู ุนูุฏูุง ูุง ุฃุณุชุฎุฏูู.",
    "ุฃูุถู ููุชูุง ุฃุทูู ููุง ุฎุทุทุช ูู ูู ุงุณุชุฎุฏุงู ุงููุงุชู.",
    "ูุฎุจุฑูู ูู ุญููู ุฃููู ุฃุณุชุฎุฏู ุงููุงุชู ูุซูุฑูุง.",
    "ุฃุณุชุฎุฏู ุงููุงุชู ููุชุฑุฉ ุฃุทูู ููุง ููุช ุฃููู.",
    "ุฃุณุชุฎุฏู ุงููุงุชู ูููุฑูุจ ูู ุงููุดุงุนุฑ ุงูุณูุจูุฉ.",
    "ุฃุดุนุฑ ุจุงูููู ุนูุฏูุง ุฃููู ุจุฏูู ุงููุงุชู."
  ];
  </script>

  <div id="sasArea"></div>

  <script>
  let sasHTML="";
  sasQs.forEach((t,i)=>{
    sasHTML+=`
      <div class="q">${i+1}. ${t}</div>
      <div class="opts">
        ${[1,2,3,4,5].map(v=>`<label><input type="radio" name="q${i+1}" value="${v}" required>${v}</label>`).join("")}
      </div>
    `;
  });
  document.addEventListener("DOMContentLoaded",()=>document.getElementById("sasArea").innerHTML=sasHTML);
  </script>

</div>

<!-- PSQI -->
<div class="section">
  <h2>PSQI โ ูููุงุณ ุฌูุฏุฉ ุงูููู (7 ุจููุฏ)</h2>

  <!-- Question Blocks -->
  <div class="q">1. ููู ุชููููู ุฌูุฏุฉ ููููุ (0 ููุชุงุฒ โฆ 3 ุณูุก ุฌุฏูุง)</div>
  <div class="opts">
    <label><input type="radio" name="s1" value="0" required>0 ููุชุงุฒ</label>
    <label><input type="radio" name="s1" value="1">1 ุฌูุฏ</label>
    <label><input type="radio" name="s1" value="2">2 ุณูุฆ</label>
    <label><input type="radio" name="s1" value="3">3 ุณูุฆ ุฌุฏูุง</label>
  </div>
  <div class="q">2. ูู ุฏูููุฉ ูุชุบููุ</div>
  <div class="opts">
    <label><input type="radio" name="s2" value="0" required>0โ15</label>
    <label><input type="radio" name="s2" value="1">16โ30</label>
    <label><input type="radio" name="s2" value="2">31โ60</label>
    <label><input type="radio" name="s2" value="3">>60</label>
  </div>
  <div class="q">3. ุณุงุนุงุช ุงูููู ุงููุนููุฉ:</div>
  <div class="opts">
    <label><input type="radio" name="s3" value="0" required>>7</label>
    <label><input type="radio" name="s3" value="1">6โ7</label>
    <label><input type="radio" name="s3" value="2">5โ6</label>
    <label><input type="radio" name="s3" value="3"><5</label>
  </div>
  <div class="q">4. ููุงุกุฉ ุงูููู:</div>
  <div class="opts">
    <label><input type="radio" name="s4" value="0" required>ุนุงููุฉ</label>
    <label><input type="radio" name="s4" value="1">ุฌูุฏุฉ</label>
    <label><input type="radio" name="s4" value="2">ููููุฉ</label>
    <label><input type="radio" name="s4" value="3">ููุฎูุถุฉ ุฌุฏูุง</label>
  </div>
  <div class="q">5. ุงุถุทุฑุงุจุงุช ุงูููู (ุงุณุชููุงุธุ ุฃุญูุงู...):</div>
  <div class="opts">
    <label><input type="radio" name="s5" value="0" required>ูู ูุญุฏุซ</label>
    <label><input type="radio" name="s5" value="1">ุฃูู ูู ูุฑุฉ</label>
    <label><input type="radio" name="s5" value="2">1โ2 ุฃุณุจูุนููุง</label>
    <label><input type="radio" name="s5" value="3">โฅ3 ุฃุณุจูุนููุง</label>
  </div>
  <div class="q">6. ุฃุฏููุฉ ุงูููู:</div>
  <div class="opts">
    <label><input type="radio" name="s6" value="0" required>ูู ูุญุฏุซ</label>
    <label><input type="radio" name="s6" value="1">ุฃูู ูู ูุฑุฉ</label>
    <label><input type="radio" name="s6" value="2">1โ2 ุฃุณุจูุนููุง</label>
    <label><input type="radio" name="s6" value="3">โฅ3 ุฃุณุจูุนููุง</label>
  </div>
  <div class="q">7. ุตุนูุจุฉ ุงูุจูุงุก ูุณุชููุธูุง ููุงุฑูุง:</div>
  <div class="opts">
    <label><input type="radio" name="s7" value="0" required>ูู ูุญุฏุซ</label>
    <label><input type="radio" name="s7" value="1">ุฃูู ูู ูุฑุฉ</label>
    <label><input type="radio" name="s7" value="2">1โ2 ุฃุณุจูุนููุง</label>
    <label><input type="radio" name="s7" value="3">โฅ3 ุฃุณุจูุนููุง</label>
  </div>

</div>

<div class="actions">
  <button type="submit">ุฅุฑุณุงู ูุญุณุงุจ ุงููุชุงุฆุฌ</button>
</div>
</form>

<div id="resultBox"></div>

</footer>
</div>

<script>
const WEB_APP_URL="https://script.google.com/macros/s/AKfycbzyXw2z6FaKmRwuProOQ7TQ3rKkdwa5ZQK_XHjD5xtsu8W7oTie__YPEqfwuXYuqxQ/exec";

function getValue(name){
  const el=document.querySelector(`[name="${name}"]:checked`);
  return el?parseInt(el.value):null;
}

document.getElementById('mainForm').addEventListener('submit',async e=>{
  e.preventDefault();

  // calculate SAS
  let sas=0;for(let i=1;i<=10;i++) sas+=getValue("q"+i);

  // calculate PSQI
  let psqi=0;for(let i=1;i<=7;i++) psqi+=getValue("s"+i);

  // interpret
  let gender=document.querySelector('[name="gender"]:checked')?.value;
  let sasTxt=(gender==="male"?(sas>=31?"ุฅุฏูุงู ูุฑุชูุน":"ุทุจูุนู"):(sas>=33?"ุฅุฏูุงู ูุฑุชูุน":"ุทุจูุนู"));
  let psqiTxt=psqi>=15?"ุงุถุทุฑุงุจ ุดุฏูุฏ":psqi>=10?"ููู ุถุนูู":psqi>=5?"ูุชูุณุท":"ุฌูุฏ ุฌุฏูุง";

  // show results
  let box=document.getElementById("resultBox");
  box.style.display="block";
  box.innerHTML=`<b>ูุชุงุฆุฌู:</b><br>๐ต ุฅุฏูุงู ุงููุงุชู: ${sas} โ ${sasTxt}<br>๐ฃ ุฌูุฏุฉ ุงูููู: ${psqi} โ ${psqiTxt}`;

  // send to sheet
  fetch(WEB_APP_URL,{
    method:"POST",
    body:JSON.stringify({sas,psqi,gender})
  });
});
</script>

</body>
</html>
